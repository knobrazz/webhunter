package main

import (
    "flag"
    "fmt"
    "log"
    "github.com/knobrazz/webhunter/exploit"
    "github.com/knobrazz/webhunter/scanner"
    "github.com/knobrazz/webhunter/hunter"
    "github.com/knobrazz/webhunter/aianalyzer"
    "github.com/knobrazz/webhunter/dorks"
)

func main() {
    target := flag.String("target", "", "Target URL")
    technique := flag.String("technique", "", "Exploitation technique")
    safeMode := flag.Bool("safe", true, "Enable safe mode")
    scanMode := flag.String("scan", "normal", "Scan mode (light|normal|aggressive)")
    aiMode := flag.Bool("ai", false, "Enable AI analysis")
    dorkMode := flag.Bool("dork", false, "Enable Google dorks")
    flag.Parse()

    if *target == "" {
        log.Fatal("Target URL is required")
    }

    // Initialize components
    exploiter := exploit.NewAutoExploiter(*safeMode)
    scanner := scanner.NewScanner(*scanMode)
    hunter := hunter.NewSmartHunter()
    
    // Run the scan
    result, err := exploiter.RunExploit(*target, *technique)
    if err != nil {
        log.Fatalf("Exploitation failed: %v", err)
    }

    if result.Success {
        fmt.Printf("Exploitation successful!\nTechnique: %s\nPayload: %s\n", 
            result.Technique, result.Payload)
    } else {
        fmt.Println("Exploitation unsuccessful")
    }
}

